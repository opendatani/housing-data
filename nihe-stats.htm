<!DOCTYPE html>
<html>
<head>
    <title>NIHE Applicant Stats</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="docs/images/favicon.png" />

    <!-- Leaflet -->
    <link rel="stylesheet" href="http://leafletjs.com/dist/leaflet.css" />
    <!--[if lte IE 8]><link rel="stylesheet" href="dist/leaflet.ie.css" /><![endif]-->
    <script src="http://leafletjs.com/dist/leaflet.js"></script>

    <!-- Highlight Charts -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <script src="housing_data.js"></script>

    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="style.css" />


</head>
<body>
    
    <div id="map" class="map"></div>

    <div id="tabs">
      <ul>
        <li><a href="#tabs-1">Allocations</a></li>
        <li><a href="#tabs-2">Points</a></li>
        <li><a href="#tabs-3">Months</a></li>
        <li><a href="#tabs-4">Arrears</a></li>
      </ul>
      <div id="tabs-1">
        <div id="chartAllocations" class="housing-chart"></div>
      </div>
      <div id="tabs-2">
        <div id="chartPoints" class="housing-chart"></div>
      </div>
      <div id="tabs-3">
        <div id="chartMonths" class="housing-chart"></div>
      </div>
      <div id="tabs-4">
        <div id="chartArrears" class="housing-chart"></div>
      </div>
    </div>


    <script>
        var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
            osmAttrib = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            osm = L.tileLayer(osmUrl, { maxZoom: 18, attribution: osmAttrib });

        var map = L.map('map').setView([54.75, -6.7], 8).addLayer(osm);

        var niheAreas = new Array();
        var niheAllocations = new Array();
        var nihePoints = new Array();
        var niheMonths = new Array();
        var niheArrears = new Array();
        var niheArrearsRound = new Array();
                
        var markers = [];

        for (var i = 0; i < json.length; i++) {
            var obj = json[i];
            var html = '<h3>Area: ' + obj.Area + '</h3>';
            html += 'Total allocations: ' + obj.Total_Allocations + '<br />';
            html += 'Average points for allocation: ' + obj.Average_Points + '<br />';
            html += 'Average month on waiting list: ' + obj.Average_Months_On_List + '<br />';
            html += 'Average current debtor arrear: ' + obj.Average_Current_Debtor_Arrear + '';

            var housingMarker = L.marker([obj.Latitude, obj.Longitude]).bindPopup(html);
            markers.push(housingMarker);

            niheAreas[i] = obj.Area;
            niheAllocations[i] = obj.Total_Allocations;
            nihePoints[i] = obj.Average_Points;
            niheMonths[i] = obj.Average_Months_On_List;
            niheArrears[i] = obj.Average_Current_Debtor_Arrear;
            niheArrearsRound[i] = Math.round(obj.Average_Current_Debtor_Arrear.substring(1));
        }
        
        var housingLayer = L.layerGroup(markers);
        
        var baseMaps = {};

        var overlayMaps = {
            "Housing": housingLayer
        };
        
        L.control.layers(baseMaps, overlayMaps).addTo(map);

    </script>


    <script type="text/javascript">
        (function ($) { // encapsulate jQuery
            $(function () {
                $('#chartAllocations').highcharts({
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Allocations made in Local Office Area by NIHE and HA\'s to Applicants for Calendar Year 2013'
                    },
                    subtitle: {
                        text: 'Source: <a href="https://www.whatdotheyknow.com/request/district_statistics"' +
                            ' target="_new">https://www.whatdotheyknow.com/request/district_statistics</a>'
                    },
                    xAxis: {
                        categories: niheAreas
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Allocations'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.0f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0
                        }
                    },
                    series: [{
                        name: 'Allocations',
                        data: niheAllocations

                    }]
                });
            });

        })(jQuery);
    </script>

    <script type="text/javascript">
        (function ($) { // encapsulate jQuery
            $(function () {
                $('#chartPoints').highcharts({
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Average points required on allocations made in Local Office Area by NIHE and HA\'s to Applicants for Calendar Year 2013'
                    },
                    subtitle: {
                        text: 'Source: <a href="https://www.whatdotheyknow.com/request/district_statistics"' +
                            ' target="_new">https://www.whatdotheyknow.com/request/district_statistics</a>'
                    },
                    xAxis: {
                        categories: niheAreas
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Points'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.0f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0
                        }
                    },
                    series: [{
                        name: 'Points',
                        data: nihePoints

                    }]
                });
            });

        })(jQuery);
    </script>

    <script type="text/javascript">
        (function ($) { // encapsulate jQuery
            $(function () {
                $('#chartMonths').highcharts({
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Average months spent on waiting list before allocations made in Local Office Area by NIHE and HA\'s to Applicants for Calendar Year 2013'
                    },
                    subtitle: {
                        text: 'Source: <a href="https://www.whatdotheyknow.com/request/district_statistics"' +
                            ' target="_new">https://www.whatdotheyknow.com/request/district_statistics</a>'
                    },
                    xAxis: {
                        categories: niheAreas
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Months'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.0f}</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0
                        }
                    },
                    series: [{
                        name: 'Months',
                        data: niheMonths

                    }]
                });
            });

        })(jQuery);
    </script>

    <script type="text/javascript">
        (function ($) { // encapsulate jQuery
            $(function () {
                $('#chartArrears').highcharts({
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Average rent arrears by Area Office at 5th January 2014'
                    },
                    subtitle: {
                        text: 'Source: <a href="https://www.whatdotheyknow.com/request/district_statistics"' +
                            ' target="_new">https://www.whatdotheyknow.com/request/district_statistics</a>'
                    },
                    xAxis: {
                        categories: niheAreas
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Arrears (£)'
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                            '<td style="padding:0"><b>{point.y:.0f} (£)</b></td></tr>',
                        footerFormat: '</table>',
                        shared: true,
                        useHTML: true
                    },
                    plotOptions: {
                        column: {
                            pointPadding: 0.2,
                            borderWidth: 0
                        }
                    },
                    series: [{
                        name: 'Arrears',
                        data: niheArrearsRound

                    }]
                });
            });

        })(jQuery);
    </script>

    <script> $(function() { $( "#tabs" ).tabs() }) </script>


</body>
</html>
